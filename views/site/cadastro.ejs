<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <a href="/" class="logo">
        <h1>Junta<br>Nova</h1>
      </a>
      <ul class="nav-links">
        <li><a href="/">Início</a></li>
        <li><a href="/produto">Produto</a></li>
        <li><a href="/login">Login</a></li>
      </ul>
    </div>
  </nav>

  <section style="padding: 4rem 0; background: var(--light-gray); min-height: 80vh;">
    <div class="container">
      <div class="form-card">
        <h2 style="color: var(--primary-blue); margin-bottom: 1.5rem; text-align: center;">Cadastre-se</h2>

        <% if (error) { %>
          <div class="error-message"><%= error %></div>
        <% } %>

        <form method="POST" action="/cadastro" id="cadastroForm">
          <div class="form-group">
            <label for="nome">Nome Completo</label>
            <input type="text" id="nome" name="nome" required>
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required>
          </div>

          <div class="form-group">
            <label for="senha">Senha</label>
            <input type="password" id="senha" name="senha" required>
          </div>

          <div class="form-group">
            <label for="telefone">Telefone</label>
            <input type="tel" id="telefone" name="telefone" placeholder="(00) 00000-0000" required>
          </div>

          <div class="form-group">
            <label for="cpf">CPF</label>
            <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required>
          </div>

          <h3 style="color: var(--primary-blue); margin: 2rem 0 1rem;">Endereço</h3>

          <div class="form-group">
            <label for="cep">CEP</label>
            <input type="text" id="cep" name="cep" placeholder="00000-000" required>
          </div>

          <div class="form-group">
            <label for="rua">Rua</label>
            <input type="text" id="rua" name="rua" required>
          </div>

          <div class="form-group">
            <label for="numero">Número</label>
            <input type="text" id="numero" name="numero" required>
          </div>

          <div class="form-group">
            <label for="complemento">Complemento</label>
            <input type="text" id="complemento" name="complemento">
          </div>

          <div class="form-group">
            <label for="bairro">Bairro</label>
            <input type="text" id="bairro" name="bairro" required>
          </div>

          <div class="form-group">
            <label for="cidade">Cidade</label>
            <input type="text" id="cidade" name="cidade" required>
          </div>

          <div class="form-group">
            <label for="estado">Estado</label>
            <select id="estado" name="estado" required>
              <option value="">Selecione</option>
              <option value="AC">Acre</option>
              <option value="AL">Alagoas</option>
              <option value="AP">Amapá</option>
              <option value="AM">Amazonas</option>
              <option value="BA">Bahia</option>
              <option value="CE">Ceará</option>
              <option value="DF">Distrito Federal</option>
              <option value="ES">Espírito Santo</option>
              <option value="GO">Goiás</option>
              <option value="MA">Maranhão</option>
              <option value="MT">Mato Grosso</option>
              <option value="MS">Mato Grosso do Sul</option>
              <option value="MG">Minas Gerais</option>
              <option value="PA">Pará</option>
              <option value="PB">Paraíba</option>
              <option value="PR">Paraná</option>
              <option value="PE">Pernambuco</option>
              <option value="PI">Piauí</option>
              <option value="RJ">Rio de Janeiro</option>
              <option value="RN">Rio Grande do Norte</option>
              <option value="RS">Rio Grande do Sul</option>
              <option value="RO">Rondônia</option>
              <option value="RR">Roraima</option>
              <option value="SC">Santa Catarina</option>
              <option value="SP">São Paulo</option>
              <option value="SE">Sergipe</option>
              <option value="TO">Tocantins</option>
            </select>
          </div>

          <div class="form-group" style="margin-top: 1rem;">
            <label style="display: flex; align-items: flex-start; gap: 0.5rem;">
              <input type="checkbox" id="aceitoTermos" name="aceitoTermos" value="on" required style="margin-top: 0.3rem;">
              <span>
                Li e concordo com os
                <a href="/termos" target="_blank" style="color: var(--primary-blue); font-weight: 600;">Termos de Uso</a>
                e a
                <a href="/privacidade" target="_blank" style="color: var(--primary-blue); font-weight: 600;">Política de Privacidade</a>.
              </span>
            </label>
          </div>

          <button type="submit" class="btn-primary" style="width: 100%; margin-top: 1rem;">Cadastrar</button>
        </form>

        <p style="text-align: center; margin-top: 1rem;">
          Já tem conta? <a href="/login" style="color: var(--primary-blue); font-weight: 600;">Faça login</a>
        </p>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2024 Junta Nova. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

  <script>
    // Buscar CEP
    document.getElementById('cep').addEventListener('blur', async (e) => {
      const cep = e.target.value.replace(/\D/g, '');
      if (cep.length === 8) {
        try {
          const response = await fetch(`/api/cep/${cep}`);
          const data = await response.json();

          if (!data.erro) {
            document.getElementById('rua').value = data.logradouro;
            document.getElementById('bairro').value = data.bairro;
            document.getElementById('cidade').value = data.localidade;
            document.getElementById('estado').value = data.uf;
          }
        } catch (error) {
          console.error('Erro ao buscar CEP:', error);
        }
      }
    });
  </script>
</body>
</html>
